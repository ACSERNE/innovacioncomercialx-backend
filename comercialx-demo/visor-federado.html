<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visor Federado por Tienda</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; background: #f4f4f4; }
    h2 { margin-top: 2rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 0.5rem; }
    th, td { border: 1px solid #ccc; padding: 0.4rem; text-align: left; }
    th { background: #eee; }
    .ok { color: green; font-weight: bold; }
    .fail { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1>🌐 Visor Federado por Tienda</h1>
  <div id="visor"></div>

  <script>
    const tiendas = {
      "demo": "https://acserne.github.io/comercialx-demo/validador-rutas.json"
      // Puedes agregar más tiendas aquí
      // "tienda2": "https://acserne.github.io/tienda2/validador-rutas.json"
    };

    const visor = document.getElementById("visor");

    Object.entries(tiendas).forEach(([nombre, url]) => {
      fetch(url)
        .then(res => res.json())
        .then(rutas => {
          const div = document.createElement("div");
          div.innerHTML = `<h2>🛍️ ${nombre}</h2><table><thead><tr><th>Ruta</th><th>Estado</th></tr></thead><tbody></tbody></table>`;
          visor.appendChild(div);

          const tbody = div.querySelector("tbody");
          rutas.forEach(ruta => {
            fetch(url.replace("validador-rutas.json", ruta), { method: "HEAD" })
              .then(res => {
                const estado = res.ok ? "✅ OK" : "❌ Error";
                const clase = res.ok ? "ok" : "fail";
                const tr = document.createElement("tr");
                tr.innerHTML = `<td>${ruta}</td><td class="${clase}">${estado}</td>`;
                tbody.appendChild(tr);
              })
              .catch(() => {
                const tr = document.createElement("tr");
                tr.innerHTML = `<td>${ruta}</td><td class="fail">❌ Error</td>`;
                tbody.appendChild(tr);
              });
          });
        });
    });
  </script>
</body>
</html>
